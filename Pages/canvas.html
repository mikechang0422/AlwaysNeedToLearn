<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Img Style</title>
    <link rel="stylesheet" href="../style/style.css">
    <style>
        .canvas {
            border: 1px solid #333;
            padding: 6px;
            width: 100%;
        }
    </style>
</head>
<body>
    <div class="warpper max_width">
        <h1 class="uppercase text_center pb_5">Canvas</h1>
        <section class="canvas_block mb_4">
            <canvas id="canvasRect" class="canvas"></canvas>
        </section>
        <section class="canvas_block">
            <canvas id="Canvas" class="canvas"></canvas>
            <img id="canvasImg" src="../Images/S__60416004.jpg" style="display: none;">
        </section>
        <section id="showImgBlock">

        </section>
        <div class="tool text_center">
            <a id="jpgBtn" class="btn" href="javascript:;" download="">下載jpg</a>
        </div>

        <div class="tool text_center">
            <a class="btn" href="./index.html">回上一頁</a>
        </div>
    </div>
    <script>
        function canvasOneHandler (){
            const canvasRect = document.querySelector('#canvasRect')
            // 顯示2D
            const ctx = canvasRect.getContext('2d')
            // 建立canvas 畫布預設 300px*150px 因為canvas設定windth:100%因此畫面的100% = 畫布的600
            canvasRect.width = 300
            canvasRect.height = 300
            // 畫筆顏色
            ctx.fillStyle = "#f00";
            // fillRect = 矩形
            ctx.fillRect(0, 0, 150, 100)
            // 線條顏色
            ctx.strokeStyle = "#fa0"
            // 線條(起點)
            ctx.moveTo(150,0)
            // 線條(終點)
            ctx.lineTo(225,100)
            // 線條粗細
            ctx.lineWidth = 2
            // 倒角 有butt round square三種,預設butt
            ctx.lineCap = 'round'
            // 繪製
            ctx.stroke()
            
            ctx.strokeStyle = "#faa"
            // 設計路徑
            ctx.beginPath()
            // 弧線 X,Y,半徑,角度
            ctx.arc(150, 50, 50, 0, 2 * Math.PI)
            ctx.stroke();
        }

        canvasOneHandler()

        function canvasTwoHandler (){
            const canvas = document.querySelector('#Canvas')
            const ctx = canvas.getContext('2d')

            // 圖片部分
            const imageObj = new Image()
            // 圖片未出現前會報錯誤因此要等圖片出現才能寫入
            imageObj.addEventListener('load', function(){
                // 畫布尺寸
                ctx.canvas.width = imageObj.width
                ctx.canvas.height = imageObj.height
                // 圖片顯示尺寸
                ctx.drawImage(imageObj, 0, 0,imageObj.width,imageObj.height)
            // let pngData = canvas.toDataURL('image/png')
            // const pngImg = new Image()
            // pngImg.src = pngData
            // document.querySelector('#showImgBlock').appendChild(pngImg)
    
            }, false)
            imageObj.src = '../Images/S__60416004.jpg'

            // 文字部分
            ctx.font = '30px 微軟正黑體'
            ctx.textAlign = 'left' //對齊方向
            ctx.textBaseline = 'top' //對齊底線
            
            ctx.fillStyle = '#fa0' //實心字顏色
            ctx.fillText('實心字', 10 , 35)
            
            ctx.strokeStyle = '#fa0' //簍空字顏色
            ctx.strokeText("簍空字", 10, 70)

            // Create gradient
            const gradient = ctx.createLinearGradient(0, 0, canvas.width, 0);
            gradient.addColorStop("0", "magenta");
            gradient.addColorStop("0.5", "blue");
            gradient.addColorStop("1.0", "red");
            ctx.strokeStyle = gradient;
            ctx.strokeText("漸變色簍空字", 10, 105)
    
            // 下載
            let jpgData = canvas.toDataURL('image/jpg')
            const jpgBtn = document.querySelector('#jpgBtn')
            jpgBtn.download = 'image.jpg'
            jpgBtn.href = jpgData
            
            // 顯示
            let pngData = canvas.toDataURL('image/png')
            const pngImg = new Image()
            pngImg.src = pngData
            document.querySelector('#showImgBlock').appendChild(pngImg)
        }

        canvasTwoHandler()
    </script>
</body>

</html>